<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="p5 Test">
<link rel="apple-touch-icon" href="favicon.png">
<link rel="icon" href="favicon.png" />
<title>p5.js 3D Box Test</title>
<style>
html,body{margin:0;padding:0;width:100vw;height:100vh;overflow:hidden;background:#111;}
canvas{display:block;}
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.min.js"></script>
<script>
let rotX = 0, rotY = 0;
let rotVX = 0, rotVY = 0;
let lastX = 0, lastY = 0;
let dragging = false;

function setup() {
  createCanvas(windowWidth, windowHeight, WEBGL);
  noStroke();

  // prevent scrolling
  document.body.addEventListener('touchmove', e => e.preventDefault(), {passive:false});
}

function draw() {
  background(20,20,40);

  // Apply momentum
  if(!dragging){
    rotX += rotVX;
    rotY += rotVY;
    rotVX *= 0.95;
    rotVY *= 0.95;
  }

  // Lighting
  ambientLight(100);
  directionalLight(255,255,255,0.25,0.25,-1);

  // Apply rotation
  rotateX(rotX);
  rotateY(rotY);

  normalMaterial();
  box(min(width,height)/3);
}

// --- Touch drag handling ---
function touchStarted() {
  if(touches.length > 0){
    lastX = touches[0].x;
    lastY = touches[0].y;
    dragging = true;
  }
}

function touchMoved() {
  if(dragging && touches.length > 0){
    let dx = touches[0].x - lastX;
    let dy = touches[0].y - lastY;

    rotY += dx * 0.01;
    rotX += dy * 0.01;

    // update momentum
    rotVY = dx * 0.01;
    rotVX = dy * 0.01;

    lastX = touches[0].x;
    lastY = touches[0].y;
  }
  return false; // prevent scrolling
}

function touchEnded() {
  dragging = false;
}

function windowResized() {
  resizeCanvas(windowWidth, windowHeight);
}
</script>
</head>
<body></body>
</html>